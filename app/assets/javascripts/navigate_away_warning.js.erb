$(window).ready(function(){
  var confirmOnPageExit = function (e) {
    // If we haven't been passed the event get the window.event
    e = e || window.event;

    var message = '<%= I18n.t("navigate_away_warning") %>';

    // For IE6-8 and Firefox prior to version 4
    if (e) {
      e.returnValue = message;
    }

    // For Chrome, Safari, IE8+ and Opera 12+
    return message;
  };
  formEl = $('form.navigate-away-warning');

  if(formEl[0]){
    window.onbeforeunload = confirmOnPageExit;

    formEl.submit(function(){
      window.onbeforeunload = null;
    })
  }
})
